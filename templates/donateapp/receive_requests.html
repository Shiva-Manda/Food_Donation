{% extends 'donateapp/base.html' %}
{% load static %}

{% block content %}
<div class="container mt-4">
  <a href="{% url 'home_authenticated' %}" class="btn btn-light mb-4">
    <i class="fas fa-arrow-left"></i> Back to Home
  </a>

  <div class="card shadow-lg mb-5 border-0">
    <div class="card-header bg-gradient-primary text-white rounded-top">
      <h3 class="m-0 text-center">
        <i class="fas fa-hand-holding-heart mr-2"></i> Food Requests for Your Donations
      </h3>
      <p class="m-0 text-center opacity-75">Thank you for sharing your food with those in need</p>
    </div>

    <div class="card-body p-4 bg-light">
      {% for req in requests %}
      <div class="request-card card mb-4 shadow-sm border-0">
        <div class="card-header bg-white d-flex justify-content-between align-items-center">
          <h5 class="m-0 text-primary">
            <i class="fas fa-user-circle mr-2"></i> Request from {{ req.user.username }}
          </h5>
          <span class="badge bg-light text-dark">
            <i class="far fa-clock mr-1"></i> {{ req.created_at|timesince }} ago
          </span>
        </div>
        
        <div class="card-body">
          <div class="row">
            <div class="col-md-6">
              <div class="info-box p-3 mb-3 bg-white rounded">
                <h6 class="text-success mb-2">
                  <i class="fas fa-utensils mr-2"></i> Food Details
                </h6>
                <p class="m-0 text-muted">{{ req.donation.food_details }}</p>
              </div>
            </div>
            <div class="col-md-6">
              <div class="info-box p-3 mb-3 bg-white rounded">
                <h6 class="text-info mb-2">
                  <i class="fas fa-comment-dots mr-2"></i> Message
                </h6>
                <p class="m-0 text-muted">{{ req.any_message|default:"No message provided" }}</p>
              </div>
            </div>
          </div>

          <div class="d-flex flex-wrap gap-3 mt-3">
            <form method="POST" class="d-flex flex-wrap gap-2">
              {% csrf_token %}
              <input type="hidden" name="request_id" value="{{ req.id }}">
              <button name="action" value="accept" class="btn btn-success px-4 py-2">
                <i class="fas fa-check-circle mr-2"></i> Accept Request
              </button>
              <button name="action" value="decline" class="btn btn-outline-danger px-4 py-2">
                <i class="fas fa-times-circle mr-2"></i> Decline
              </button>
            </form>
          </div>
        </div>
      </div>
      {% empty %}
      <div class="empty-state text-center py-5 bg-white rounded">
        <i class="fas fa-inbox-open fa-4x mb-3 text-muted"></i>
        <h4 class="text-muted">No Pending Requests</h4>
        <p class="text-muted">You'll see food requests here when people show interest in your donations</p>
        <a href="{% url 'donare' %}" class="btn btn-primary mt-2">
          <i class="fas fa-utensils mr-2"></i> Create New Donation
        </a>
      </div>
      {% endfor %}
    </div>
  </div>
</div>

<style>
  .request-card {
    transition: all 0.3s ease;
    border-left: 4px solid #4e73df;
  }
  .request-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1) !important;
  }
  .bg-gradient-primary {
    background: linear-gradient(135deg, #4e73df 0%, #224abe 100%);
  }
  .info-box {
    border: 1px solid #e3e6f0;
  }
  .btn-success {
    background-color: #1cc88a;
    border-color: #1cc88a;
  }
  .btn-success:hover {
    background-color: #17a673;
    border-color: #17a673;
  }
  .empty-state {
    border: 1px dashed #e3e6f0;
  }
</style>
{% endblock %}
